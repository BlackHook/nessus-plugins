#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501132);
  script_version("1.5");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/07");

  script_cve_id("CVE-2019-12264");
  script_xref(name:"CEA-ID", value:"CEA-2019-0679");

  script_name(english:"ABB (CVE-2019-12264)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Wind River is the provider of a real time operating system called 
VxWorks which is used in the embedded software of the PM 877 Controller. 
Wind River has announced security vulnerabilities in the VxWorks
TCP/IP stack (IPnet) and management of memory block size (Bad Alloc).
The controller PM 877 is affected by vulnerabilities in the TCP/IP 
stack but it is not affected by the vulnerabilities related to memory 
management (Bad Alloc). All the associated vulnerabilities which 
impacted the PM 877 have been corrected. An attacker who successfully 
exploits these vulnerabilities could hijack existing TCP sessions 
to inject malformed packets or steal authenticated user session 
identifiers, resulting in corruptions of data, unauthorized 
disclosure of information, denial of service and data communications 
outage or even code execution. The vulnerabilities do not target any 
ABB products specifically, but potentially affect products that use 
the operating system.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://library.e.abb.com/public/f626af884f204f74bd0e0cbc63e7cee6/7PAA000401_en_SECURITY_ADVISORY_Melody_Rack_PM877_Multiple_Vulnerabilities.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?d92586e2");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:L/Au:N/C:N/I:P/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-12264");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_cwe_id(120);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/08/09");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/08/09");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/05/10");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:abb:pm877_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/ABB");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/ABB');

var asset = tenable_ot::assets::get(vendor:'ABB');

var vuln_cpes = {
    "cpe:/o:abb:pm877_firmware" :
        {"versionEndExcluding" : "3.40", "family" : "MelodyRack"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
