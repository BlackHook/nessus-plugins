#%NASL_MIN_LEVEL 70300
##
# (C) Tenable Network Security, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(500362);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/04/18");

  script_cve_id("CVE-2019-19281");

  script_name(english:"Siemens (CVE-2019-19281)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in SIMATIC ET 200SP Open Controller CPU 1515SP PC2 (incl. SIPLUS variants) (All
versions >= V2.5 and < V20.8), SIMATIC S7-1500 CPU family (incl. related ET200 CPUs and SIPLUS variants) (All versions
>= V2.5 and < V2.8), SIMATIC S7-1500 Software Controller (All versions >= V2.5 and < V20.8). Affected devices contain a
vulnerability that allows an unauthenticated attacker to trigger a Denial-of-Service condition. The vulnerability can be
triggered if specially crafted UDP packets are sent to the device. The security vulnerability could be exploited by an
attacker with network access to the affected systems. Successful exploitation requires no system privileges and no user
interaction. An attacker could use the vulnerability to compromise the device availability.  

This plugin only works
with Tenable.ot. Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-750824.pdf");
  script_set_attribute(attribute:"see_also", value:"https://www.us-cert.gov/ics/advisories/icsa-20-042-11");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-19281");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2020/03/10");
  script_set_attribute(attribute:"patch_publication_date", value:"2020/03/10");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/02/07");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_et_200sp_open_controller_cpu_1515sp_pc2_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1511-1_pn_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1513-1_pn_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1515-2_pn_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1516-3_pn_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1516-3_dp_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1517-3_pn_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1517-3_dp_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1518-4_pn_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1518-4_dp_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1507s_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1508s_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1507s_f_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_cpu_1508s_f_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:simatic_et_200sp_open_controller_cpu_1515sp_pc2_firmware" :
        {"versionEndExcluding" : "20.8", "versionStartIncluding" : "2.5", "family" : "ET200SP"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1511-1_pn_firmware" :
        {"versionEndExcluding" : "2.8", "versionStartIncluding" : "2.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1513-1_pn_firmware" :
        {"versionEndExcluding" : "2.8", "versionStartIncluding" : "2.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1515-2_pn_firmware" :
        {"versionEndExcluding" : "2.8", "versionStartIncluding" : "2.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1516-3_pn_firmware" :
        {"versionEndExcluding" : "2.8", "versionStartIncluding" : "2.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1516-3_dp_firmware" :
        {"versionEndExcluding" : "2.8", "versionStartIncluding" : "2.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1517-3_pn_firmware" :
        {"versionEndExcluding" : "2.8", "versionStartIncluding" : "2.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1517-3_dp_firmware" :
        {"versionEndExcluding" : "2.8", "versionStartIncluding" : "2.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1518-4_pn_firmware" :
        {"versionEndExcluding" : "2.8", "versionStartIncluding" : "2.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1518-4_dp_firmware" :
        {"versionEndExcluding" : "2.8", "versionStartIncluding" : "2.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1507s_firmware" :
        {"versionEndExcluding" : "20.8", "versionStartIncluding" : "2.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1508s_firmware" :
        {"versionEndExcluding" : "20.8", "versionStartIncluding" : "2.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1507s_f_firmware" :
        {"versionEndExcluding" : "20.8", "versionStartIncluding" : "2.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_cpu_1508s_f_firmware" :
        {"versionEndExcluding" : "20.8", "versionStartIncluding" : "2.5", "family" : "S71500"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
