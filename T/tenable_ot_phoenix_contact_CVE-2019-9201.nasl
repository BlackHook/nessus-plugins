#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500775);
  script_version("1.0");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/01/25");

  script_cve_id("CVE-2019-9201");

  script_name(english:"Phoenix Contact (CVE-2019-9201)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Multiple Phoenix Contact devices allow remote attackers to establish
TCP sessions to port 1962 and obtain sensitive information or make
changes, as demonstrated by using the Create Backup feature to
traverse all directories.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://medium.com/@SergiuSechel/misconfiguration-in-ilc-gsm-gprs-devices-leaves-over-1-200-ics-devices-vulnerable-to-attacks-over-82c2d4a91561
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?a72318f1");
  script_set_attribute(attribute:"see_also", value:"https://cert.vde.com/en/advisories/VDE-2019-015/");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-9201");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(306);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/02/26");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/02/26");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/01/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:phoenixcontact:axc_1050_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:phoenixcontact:ilc_131_eth%2fxc_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:phoenixcontact:ilc_131_eth_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:phoenixcontact:ilc_151_eth%2fxc_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:phoenixcontact:ilc_151_eth_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:phoenixcontact:ilc_171_eth_2tx_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:phoenixcontact:ilc_191_eth_2tx_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:phoenixcontact:ilc_191_me%2fan_firmware:-");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/PhoenixContact");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/PhoenixContact');

var asset = tenable_ot::assets::get(vendor:'PhoenixContact');

var vuln_cpes = {
    "cpe:/o:phoenixcontact:ilc_131_eth_firmware:-" :
        {"family" : "ILC100"},
    "cpe:/o:phoenixcontact:ilc_131_eth%2fxc_firmware:-" :
        {"family" : "ILC100"},
    "cpe:/o:phoenixcontact:ilc_151_eth_firmware:-" :
        {"family" : "ILC100"},
    "cpe:/o:phoenixcontact:ilc_151_eth%2fxc_firmware:-" :
        {"family" : "ILC100"},
    "cpe:/o:phoenixcontact:ilc_171_eth_2tx_firmware:-" :
        {"family" : "ILC100"},
    "cpe:/o:phoenixcontact:ilc_191_eth_2tx_firmware:-" :
        {"family" : "ILC100"},
    "cpe:/o:phoenixcontact:ilc_191_me%2fan_firmware:-" :
        {"family" : "ILC100"},
    "cpe:/o:phoenixcontact:axc_1050_firmware:-" :
        {"family" : "AXC1000"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
