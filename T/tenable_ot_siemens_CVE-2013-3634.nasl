#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500759);
  script_version("1.0");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/01/25");

  script_cve_id("CVE-2013-3634");

  script_name(english:"Siemens (CVE-2013-3634)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in SCALANCE X-200 switch family
(incl. SIPLUS NET variants) (Versions < V5.0.0 for CVE-2013-3633 and
versions < V4.5.0 for CVE-2013-3634), SCALANCE X-200IRT switch family
(incl. SIPLUS NET variants) (All versions < V5.1.0). The
implementation of SNMPv3 does not check the user credentials
sufficiently. Therefore, an attacker is able to execute SNMP commands
without correct credentials.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-170686.pdf");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:P");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2013-3634");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(20);

  script_set_attribute(attribute:"vuln_publication_date", value:"2013/05/24");
  script_set_attribute(attribute:"patch_publication_date", value:"2013/05/24");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/01/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:siemens:scalance_x200-4p_irt:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:siemens:scalance_x201-3p_irt:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:siemens:scalance_x201-3p_irt:-:-:pro");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:siemens:scalance_x202-2irt:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:siemens:scalance_x202-2p_irt:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:siemens:scalance_x202-2p_irt:-:-:pro");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:siemens:scalance_x204irt:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:siemens:scalance_x204irt:-:-:pro");
  script_set_attribute(attribute:"cpe", value:"cpe:/h:siemens:scalance_xf204irt:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x200irt_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:scalance_x200irt_firmware" :
        {"versionEndIncluding" : "5.0.0", "family" : "SCALANCE"},
    "cpe:/h:siemens:scalance_x200-4p_irt:-" :
        {"family" : "SCALANCE"},
    "cpe:/h:siemens:scalance_x201-3p_irt:-:-:pro" :
        {"family" : "SCALANCE"},
    "cpe:/h:siemens:scalance_x201-3p_irt:-" :
        {"family" : "SCALANCE"},
    "cpe:/h:siemens:scalance_x202-2irt:-" :
        {"family" : "SCALANCE"},
    "cpe:/h:siemens:scalance_x202-2p_irt:-" :
        {"family" : "SCALANCE"},
    "cpe:/h:siemens:scalance_x202-2p_irt:-:-:pro" :
        {"family" : "SCALANCE"},
    "cpe:/h:siemens:scalance_x204irt:-:-:pro" :
        {"family" : "SCALANCE"},
    "cpe:/h:siemens:scalance_x204irt:-" :
        {"family" : "SCALANCE"},
    "cpe:/h:siemens:scalance_xf204irt:-" :
        {"family" : "SCALANCE"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
