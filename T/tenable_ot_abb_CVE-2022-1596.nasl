##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500661);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/04/18");

  script_cve_id("CVE-2022-1596");

  script_name(english:"ABB (CVE-2022-1596)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Incorrect Permission Assignment for Critical Resource vulnerability in ABB REX640 PCL1, REX640 PCL2, REX640 PCL3 allows
an authenticated attacker to launch an attack against the user database file and try to take control of an affected
system node.

  - Incorrect Permission Assignment for Critical Resource vulnerability in ABB REX640 PCL1, REX640 PCL2,
    REX640 PCL3 allows an authenticated attacker to launch an attack against the user database file and try to
    take control of an affected system node. (CVE-2022-1596)

This plugin only works with Tenable.ot. Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://search.abb.com/library/Download.aspx?DocumentID=2NGA001421");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:S/C:P/I:N/A:N");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-1596");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(732);

  script_set_attribute(attribute:"vuln_publication_date", value:"2022/06/21");
  script_set_attribute(attribute:"patch_publication_date", value:"2022/06/21");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/06/29");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:abb:rex640_pcl1_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:abb:rex640_pcl2_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:abb:rex640_pcl3_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/ABB");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/ABB');

var asset = tenable_ot::assets::get(vendor:'ABB');

var vuln_cpes = {
    "cpe:/o:abb:rex640_pcl1_firmware" :
        {"versionEndIncluding" : "1.0.7", "family" : "AbbRelion"},
    "cpe:/o:abb:rex640_pcl2_firmware" :
        {"versionEndExcluding" : "1.1.4", "family" : "AbbRelion"},
    "cpe:/o:abb:rex640_pcl3_firmware" :
        {"versionEndExcluding" : "1.2.1", "family" : "AbbRelion"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
