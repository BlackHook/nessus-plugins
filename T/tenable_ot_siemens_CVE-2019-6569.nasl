#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501032);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/10");

  script_cve_id("CVE-2019-6569");

  script_name(english:"Siemens (CVE-2019-6569)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"The monitor barrier of the affected products insufficiently blocks
data from being forwarded over the mirror port into the mirrored
network. An attacker could use this behavior to transmit malicious
packets to systems in the mirrored network, possibly influencing their
configuration and runtime behavior.

Matching for this plugin is performed on model name, as they are
listed in the Siemens advisory. For the exact MLFBs matching, please
refer to the Siemens ssa-557804. 

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-557804.pdf");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-6569");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(440);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/03/26");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/03/26");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/04/11");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x-200_series_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x-300_series_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xc-200_series_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xf-200_series_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_xp-200_series_firmware");
  script_set_attribute(attribute:"generated_plugin", value:"former");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_models = {
    "SCALANCE X204-2" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X204-2 FM" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X204-2LD" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X204-2LD TS" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X204-2TS" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X206-1" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X206-1LD" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X208" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X208PRO" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X212-2" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X212-2LD" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X216" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X224" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE X302-7 EEC" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X304-2FE" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X306-1LD FE" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X307-2 EEC" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X307-3" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X307-3LD" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X308-2" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X308-2LD" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X308-2LH" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X308-2LH+" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X308-2M" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X308-2M PoE" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X308-2M TS" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X310" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X310FE" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X320-1 FE" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X320-1-2LD FE" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE X408-2" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX400"},
    "SCALANCE XB205-3" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XB205-3LD" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XB208" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XB213-3" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XB213-3LD" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XB216" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC206-2" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC206-2SFP" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC206-2SFP EEC" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC206-2SFP G" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC206-2SFP G EEC" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC208" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC208EEC" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC208G" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC208G EEC" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC216" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC216-4C G" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC216-4C G EEC" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC216EEC" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC224" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC224-4C G" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XC224-4C G EEC" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XF204" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE XF204 DNA" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XF204-2" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE XF204-2BA" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XF204-2BA DNA" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XF206-1" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE XF208" :
        {"versionEndExcluding" : "5.2.6", "family" : "SCALANCEX200"},
    "SCALANCE XP208" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XP208EEC" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XP216" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XP216EEC" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XP216POE EEC" :
        {"versionEndExcluding" : "4.1", "family" : "SCALANCEX200"},
    "SCALANCE XR324-12M" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE XR324-12M TS" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE XR324-4M EEC" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE XR324-4M PoE" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE XR324-4M PoE TS" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE XR324WG" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
    "SCALANCE XR328-4C WG" :
        {"versionEndExcluding" : "4.1.3", "family" : "SCALANCEX300"},
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_models, severity:SECURITY_WARNING);
