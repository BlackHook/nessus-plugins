#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500837);
  script_version("1.0");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/02/21");

  script_cve_id("CVE-2022-40267");

  script_name(english:"Mitsubishi (CVE-2022-40267)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Predictable Seed in Pseudo-Random Number Generator (PRNG)
vulnerability in Mitsubishi Electric Corporation MELSEC iQ-F Series
FX5U-xMy/z (x=32,64,80, y=T,R, z=ES,DS,ESS,DSS) with serial number
17X**** or later, and versions 1.280 and prior, Mitsubishi Electric
Corporation MELSEC iQ-F Series FX5U-xMy/z (x=32,64,80, y=T,R,
z=ES,DS,ESS,DSS) with serial number 179**** and prior, and versions
1.074 and prior, Mitsubishi Electric Corporation MELSEC iQ-F Series
FX5UC-xMy/z (x=32,64,96, y=T, z=D,DSS)) with serial number 17X**** or
later, and versions 1.280 and prior, Mitsubishi Electric Corporation
MELSEC iQ-F Series FX5UC-xMy/z (x=32,64,96, y=T, z=D,DSS)) with serial
number 179**** and prior, and versions 1.074 and prior, Mitsubishi
Electric Corporation MELSEC iQ-F Series FX5UC-32MT/DS-TS versions
1.280 and prior, Mitsubishi Electric Corporation MELSEC iQ-F Series
FX5UC-32MT/DSS-TS versions 1.280 and prior, Mitsubishi Electric
Corporation MELSEC iQ-F Series FX5UJ-xMy/z (x=24,40,60, y=T,R,
z=ES,ESS) versions 1.042 and prior, Mitsubishi Electric Corporation
MELSEC iQ-F Series FX5UJ-xMy/ES-A (x=24,40,60, y=T,R) versions 1.043
and prior, Mitsubishi Electric Corporation MELSEC iQ-F Series
FX5S-xMy/z (x=30,40,60,80, y=T,R, z=ES,ESS) versions 1.003 and prior,
Mitsubishi Electric Corporation MELSEC iQ-F Series FX5UC-32MR/DS-TS
versions 1.280 and prior, Mitsubishi Electric Corporation MELSEC iQ-R
Series R00/01/02CPU all versions, Mitsubishi Electric Corporation
MELSEC iQ-R Series R04/08/16/32/120(EN)CPU all versions allows a
remote unauthenticated attacker to access the Web server function by
guessing the random numbers used for authentication from several used
random numbers.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://www.mitsubishielectric.com/en/psirt/vulnerability/pdf/2022-019_en.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?90f10851");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/uscert/ics/advisories/icsa-23-017-02");
  script_set_attribute(attribute:"see_also", value:"https://jvn.jp/vu/JVNVU99673580/index.html");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-40267");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(335);

  script_set_attribute(attribute:"vuln_publication_date", value:"2023/01/20");
  script_set_attribute(attribute:"patch_publication_date", value:"2023/01/20");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/02/21");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r00cpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r01cpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r02cpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r04cpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r04encpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r08cpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r08encpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r120cpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r120encpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r16cpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r16encpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r32cpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:r32encpu_firmware:-");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Mitsubishi");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Mitsubishi');

var asset = tenable_ot::assets::get(vendor:'Mitsubishi');

var vuln_cpes = {
    "cpe:/o:mitsubishielectric:r00cpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:r01cpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:r02cpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:r04cpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:r08cpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:r16cpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:r32cpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:r120cpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:r04encpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:r08encpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:r16encpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:r32encpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:r120encpu_firmware:-" :
        {"family" : "MELSECiQR"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
