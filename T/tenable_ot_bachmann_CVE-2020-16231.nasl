##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500654);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/04/18");

  script_cve_id("CVE-2020-16231");

  script_name(english:"Bachmann (CVE-2020-16231)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"The affected Bachmann Electronic M-Base Controllers of version MSYS
v1.06.14 and later use weak cryptography to protect device passwords.
Affected controllers that are actively supported include MX207, MX213,
MX220, MC206, MC212, MC220, and MH230 hardware controllers, and
affected end-of-life controller include MC205, MC210, MH212, ME203,
CS200, MP213, MP226, MPC240, MPC265, MPC270, MPC293, MPE270, and
CPC210 hardware controllers. Security Level 0 is set at default from
the manufacturer, which could allow an unauthenticated remote attacker
to gain access to the password hashes. Security Level 4 is susceptible
if an authenticated remote attacker or an unauthenticated person with
physical access to the device reads and decrypts the password to
conduct further attacks.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/uscert/ics/advisories/icsa-21-026-02");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:S/C:P/I:P/A:P");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2020-16231");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(916);

  script_set_attribute(attribute:"vuln_publication_date", value:"2022/05/19");
  script_set_attribute(attribute:"patch_publication_date", value:"2022/05/19");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/06/14");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:cpc210_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:cs200_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mc205_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mc206_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mc210_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mc212_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mc220_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:me203_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mh212_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mh230_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mp213_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mp226_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mpc240_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mpc265_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mpc270_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mpc293_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mpe270_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mx207_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mx213_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:bachmann:mx220_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Bachmann");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Bachmann');

var asset = tenable_ot::assets::get(vendor:'Bachmann');

var vuln_cpes = {
    "cpe:/o:bachmann:mx207_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mx213_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mx220_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mc206_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mc212_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mc220_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mh230_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mc205_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mc210_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mh212_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:me203_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:cs200_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mp213_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mp226_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mpc240_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mpc265_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mpc270_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mpc293_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:mpe270_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"},
    "cpe:/o:bachmann:cpc210_firmware" :
        {"versionStartIncluding" : "1.06.14", "family" : "Bachmann"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
