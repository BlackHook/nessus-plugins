#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500746);
  script_version("1.0");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/01/25");

  script_cve_id("CVE-2018-4833");

  script_name(english:"Siemens (CVE-2018-4833)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in RFID 181EIP (All versions),
RUGGEDCOM Win (V4.4, V4.5, V5.0, and V5.1), SCALANCE X-200 switch
family (incl. SIPLUS NET variants) (All versions < V5.2.3), SCALANCE
X-200IRT switch family (incl. SIPLUS NET variants) (All versions <
V5.4.1), SCALANCE X-200RNA switch family (All versions < V3.2.6),
SCALANCE X-300 switch family (incl. SIPLUS NET variants) (All versions
< V4.1.3), SCALANCE X408 (All versions < V4.1.3), SCALANCE X414 (All
versions), SIMATIC RF182C (All versions). Unprivileged remote
attackers located in the same local network segment (OSI Layer 2)
could gain remote code execution on the affected products by sending a
specially crafted DHCP response to a client's DHCP request.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-181018.pdf");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2018-4833");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(122);

  script_set_attribute(attribute:"vuln_publication_date", value:"2018/06/14");
  script_set_attribute(attribute:"patch_publication_date", value:"2018/06/14");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/01/25");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x200_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x200irt_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x204rna_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x300_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x408_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x414_firmware:-");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:scalance_x200_firmware" :
        {"versionEndExcluding" : "5.2.3", "family" : "SCALANCE"},
    "cpe:/o:siemens:scalance_x200irt_firmware" :
        {"versionEndExcluding" : "5.4.1", "family" : "SCALANCE"},
    "cpe:/o:siemens:scalance_x204rna_firmware:-" :
        {"family" : "SCALANCE"},
    "cpe:/o:siemens:scalance_x300_firmware:-" :
        {"family" : "SCALANCE"},
    "cpe:/o:siemens:scalance_x408_firmware:-" :
        {"family" : "SCALANCE"},
    "cpe:/o:siemens:scalance_x414_firmware:-" :
        {"family" : "SCALANCE"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
