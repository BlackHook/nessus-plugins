##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(500663);
  script_version("1.3");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/04/04");

  script_cve_id("CVE-2022-30707");

  script_name(english:"Yokogawa (CVE-2022-30707)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Violation of secure design principles exists in the communication of CAMS for HIS. Affected products and versions are
CENTUM series where LHS4800 is installed (CENTUM CS 3000 and CENTUM CS 3000 Small R3.08.10 to R3.09.00), CENTUM series
where CAMS function is used (CENTUM VP, CENTUM VP Small, and CENTUM VP Basic R4.01.00 to R4.03.00), CENTUM series
regardless of the use of CAMS function (CENTUM VP, CENTUM VP Small, and CENTUM VP Basic R5.01.00 to R5.04.20 and
R6.01.00 to R6.09.00), Exaopc R3.72.00 to R3.80.00 (only if NTPF100-S6 'For CENTUM VP Support CAMS for HIS' is
installed), B/M9000 CS R5.04.01 to R5.05.01, and B/M9000 VP R6.01.01 to R8.03.01). If an adjacent attacker successfully
compromises a computer using CAMS for HIS software, they can use credentials from the compromised machine to access data
from another machine using CAMS for HIS software. This can lead to a disabling of CAMS for HIS software functions on any
affected machines, or information disclosure/alteration.

  - Violation of secure design principles exists in the communication of CAMS for HIS. Affected products and
    versions are CENTUM series where LHS4800 is installed (CENTUM CS 3000 and CENTUM CS 3000 Small R3.08.10 to
    R3.09.00), CENTUM series where CAMS function is used (CENTUM VP, CENTUM VP Small, and CENTUM VP Basic
    R4.01.00 to R4.03.00), CENTUM series regardless of the use of CAMS function (CENTUM VP, CENTUM VP Small,
    and CENTUM VP Basic R5.01.00 to R5.04.20 and R6.01.00 to R6.09.00), Exaopc R3.72.00 to R3.80.00 (only if
    NTPF100-S6 'For CENTUM VP Support CAMS for HIS' is installed), B/M9000 CS R5.04.01 to R5.05.01, and
    B/M9000 VP R6.01.01 to R8.03.01). If an adjacent attacker successfully compromises a computer using CAMS
    for HIS software, they can use credentials from the compromised machine to access data from another
    machine using CAMS for HIS software. This can lead to a disabling of CAMS for HIS software functions on
    any affected machines, or information disclosure/alteration. (CVE-2022-30707)

This plugin only works with Tenable.ot. Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://www.cisa.gov/uscert/ics/advisories/icsa-22-174-02");
  script_set_attribute(attribute:"see_also", value:"https://web-material3.yokogawa.com/19/32780/files/YSAR-22-0006-J.pdf");
  script_set_attribute(attribute:"see_also", value:"https://jvn.jp/vu/JVNVU92819891/index.html");
  script_set_attribute(attribute:"see_also", value:"https://web-material3.yokogawa.com/1/32780/files/YSAR-22-0006-E.pdf");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:A/AC:M/Au:N/C:P/I:P/A:P");
  script_set_cvss3_base_vector("CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-30707");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");

  script_set_attribute(attribute:"vuln_publication_date", value:"2022/06/28");
  script_set_attribute(attribute:"patch_publication_date", value:"2022/06/28");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/07/15");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_cs_3000_entry_class_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_cs_3000_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_vp_entry_class_firmware:r4");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_vp_entry_class_firmware:r5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_vp_entry_class_firmware:r6");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_vp_firmware:r4");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_vp_firmware:r5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_vp_firmware:r6");
  script_set_attribute(attribute:"generated_plugin", value:"current");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Yokogawa");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Yokogawa');

var asset = tenable_ot::assets::get(vendor:'Yokogawa');

var vuln_cpes = {
    "cpe:/o:yokogawa:centum_cs_3000_firmware" :
        {"versionEndIncluding" : "r3.09.00", "versionStartIncluding" : "r3.08.10", "family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_cs_3000_entry_class_firmware" :
        {"versionEndIncluding" : "r3.09.00", "versionStartIncluding" : "r3.08.10", "family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_vp_firmware:r5" :
        {"versionEndIncluding" : "r5.04.20", "versionStartIncluding" : "r5.01.00", "family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_vp_firmware:r4" :
        {"versionEndIncluding" : "r4.03.00", "versionStartIncluding" : "r4.01.00", "family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_vp_firmware:r6" :
        {"versionEndIncluding" : "r6.09.00", "versionStartIncluding" : "r6.01.00", "family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_vp_entry_class_firmware:r6" :
        {"versionEndIncluding" : "r6.09.00", "versionStartIncluding" : "r6.01.00", "family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_vp_entry_class_firmware:r5" :
        {"versionEndIncluding" : "r5.04.20", "versionStartIncluding" : "r5.01.00", "family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_vp_entry_class_firmware:r4" :
        {"versionEndIncluding" : "r4.03.00", "versionStartIncluding" : "r4.01.00", "family" : "CentumVP"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
