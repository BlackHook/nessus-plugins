#%NASL_MIN_LEVEL 70300
##
# (C) Tenable Network Security, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(500395);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/04/18");

  script_cve_id("CVE-2020-5652");

  script_name(english:"Mitsubishi (CVE-2020-5652)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"Uncontrolled resource consumption vulnerability in Ethernet Port on MELSEC iQ-R, Q and L series CPU modules (R 00/01/02
CPU firmware versions '20' and earlier, R 04/08/16/32/120 (EN) CPU firmware versions '52' and earlier, R 08/16/32/120
SFCPU firmware versions '22' and earlier, R 08/16/32/120 PCPU all versions, R 08/16/32/120 PSFCPU all versions, R
16/32/64 MTCPU all versions, Q03 UDECPU, Q 04/06/10/13/20/26/50/100 UDEHCPU serial number '22081' and earlier , Q
03/04/06/13/26 UDVCPU serial number '22031' and earlier, Q 04/06/13/26 UDPVCPU serial number '22031' and earlier, Q
172/173 DCPU all versions, Q 172/173 DSCPU all versions, Q 170 MCPU all versions, Q 170 MSCPU all versions, L 02/06/26
CPU (-P) and L 26 CPU - (P) BT all versions) allows a remote unauthenticated attacker to stop the Ethernet communication
functions of the products via a specially crafted packet, which may lead to a denial of service (DoS) condition .   This
plugin only works with Tenable.ot. Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://www.mitsubishielectric.com/en/psirt/vulnerability/pdf/2020-013_en.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?3f5c6d18");
  script_set_attribute(attribute:"see_also", value:"https://jvn.jp/vu/JVNVU96558207/index.html");
  # https://www.mitsubishielectric.co.jp/psirt/vulnerability/pdf/2020-013.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?066cb413");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2020-5652");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2020/11/02");
  script_set_attribute(attribute:"patch_publication_date", value:"2020/11/02");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/02/07");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q04udpvcpu_firmware:22031");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q06udpvcpu_firmware:22031");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q13udpvcpu_firmware:22031");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q26udpvcpu_firmware:22031");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q03udvcpu_firmware:22031");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q04udvcpu_firmware:22031");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q13udvcpu_firmware:22031");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q26udvcpu_firmware:22031");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q03udecpu_firmware:22081");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q04udehcpu_firmware:22081");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q06udehcpu_firmware:22081");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q10udehcpu_firmware:22081");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q13udehcpu_firmware:22081");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q20udehcpu_firmware:22081");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q26udehcpu_firmware:22081");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q50udehcpu_firmware:22081");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q100udehcpu_firmware:22081");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r08sfcpu_firmware:22");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r16sfcpu_firmware:22");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r32sfcpu_firmware:22");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r120sfcpu_firmware:22");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r04encpu_firmware:52");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r08encpu_firmware:52");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r16encpu_firmware:52");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r32encpu_firmware:52");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r120encpu_firmware:52");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r00cpu_firmware:20");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r01cpu_firmware:20");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r02cpu_firmware:20");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r08pcpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r08psfcpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r120pcpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r120psfcpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r16mtcpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r16pcpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r16psfcpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r32mtcpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r32pcpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r32psfcpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_iq-r64mtcpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_l02cpu-p_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_l06cpu-p_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_l26cpu-p_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_l26cpu-pbt_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q170mcpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q170mscpu-s1_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q172dcpu-s1_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q172dscpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q173dcpu-s1_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-q173dscpu_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:mitsubishielectric:melsec_q-qmr-mq100_firmware:-");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Mitsubishi");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Mitsubishi');

var asset = tenable_ot::assets::get(vendor:'Mitsubishi');

var vuln_cpes = {
    "cpe:/o:mitsubishielectric:melsec_q-q04udpvcpu_firmware:22031" :
        {"versionEndIncluding" : "22031", "versionStartIncluding" : "22031", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q06udpvcpu_firmware:22031" :
        {"versionEndIncluding" : "22031", "versionStartIncluding" : "22031", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q13udpvcpu_firmware:22031" :
        {"versionEndIncluding" : "22031", "versionStartIncluding" : "22031", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q26udpvcpu_firmware:22031" :
        {"versionEndIncluding" : "22031", "versionStartIncluding" : "22031", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q03udvcpu_firmware:22031" :
        {"versionEndIncluding" : "22031", "versionStartIncluding" : "22031", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q04udvcpu_firmware:22031" :
        {"versionEndIncluding" : "22031", "versionStartIncluding" : "22031", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q13udvcpu_firmware:22031" :
        {"versionEndIncluding" : "22031", "versionStartIncluding" : "22031", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q26udvcpu_firmware:22031" :
        {"versionEndIncluding" : "22031", "versionStartIncluding" : "22031", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q03udecpu_firmware:22081" :
        {"versionEndIncluding" : "22081", "versionStartIncluding" : "22081", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q04udehcpu_firmware:22081" :
        {"versionEndIncluding" : "22081", "versionStartIncluding" : "22081", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q06udehcpu_firmware:22081" :
        {"versionEndIncluding" : "22081", "versionStartIncluding" : "22081", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q10udehcpu_firmware:22081" :
        {"versionEndIncluding" : "22081", "versionStartIncluding" : "22081", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q13udehcpu_firmware:22081" :
        {"versionEndIncluding" : "22081", "versionStartIncluding" : "22081", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q20udehcpu_firmware:22081" :
        {"versionEndIncluding" : "22081", "versionStartIncluding" : "22081", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q26udehcpu_firmware:22081" :
        {"versionEndIncluding" : "22081", "versionStartIncluding" : "22081", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q50udehcpu_firmware:22081" :
        {"versionEndIncluding" : "22081", "versionStartIncluding" : "22081", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q100udehcpu_firmware:22081" :
        {"versionEndIncluding" : "22081", "versionStartIncluding" : "22081", "family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_iq-r08sfcpu_firmware:22" :
        {"versionEndIncluding" : "22", "versionStartIncluding" : "22", "family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r16sfcpu_firmware:22" :
        {"versionEndIncluding" : "22", "versionStartIncluding" : "22", "family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r32sfcpu_firmware:22" :
        {"versionEndIncluding" : "22", "versionStartIncluding" : "22", "family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r120sfcpu_firmware:22" :
        {"versionEndIncluding" : "22", "versionStartIncluding" : "22", "family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r04encpu_firmware:52" :
        {"versionEndIncluding" : "52", "versionStartIncluding" : "52", "family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r08encpu_firmware:52" :
        {"versionEndIncluding" : "52", "versionStartIncluding" : "52", "family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r16encpu_firmware:52" :
        {"versionEndIncluding" : "52", "versionStartIncluding" : "52", "family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r32encpu_firmware:52" :
        {"versionEndIncluding" : "52", "versionStartIncluding" : "52", "family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r120encpu_firmware:52" :
        {"versionEndIncluding" : "52", "versionStartIncluding" : "52", "family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r00cpu_firmware:20" :
        {"versionEndIncluding" : "20", "versionStartIncluding" : "20", "family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r01cpu_firmware:20" :
        {"versionEndIncluding" : "20", "versionStartIncluding" : "20", "family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r02cpu_firmware:20" :
        {"versionEndIncluding" : "20", "versionStartIncluding" : "20", "family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r08pcpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r08psfcpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r120pcpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r120psfcpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r16mtcpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r16pcpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r16psfcpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r32mtcpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r32pcpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r32psfcpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_iq-r64mtcpu_firmware:-" :
        {"family" : "MELSECiQR"},
    "cpe:/o:mitsubishielectric:melsec_l02cpu-p_firmware:-" :
        {"family" : "MELSECL"},
    "cpe:/o:mitsubishielectric:melsec_l06cpu-p_firmware:-" :
        {"family" : "MELSECL"},
    "cpe:/o:mitsubishielectric:melsec_l26cpu-p_firmware:-" :
        {"family" : "MELSECL"},
    "cpe:/o:mitsubishielectric:melsec_l26cpu-pbt_firmware:-" :
        {"family" : "MELSECL"},
    "cpe:/o:mitsubishielectric:melsec_q-q170mcpu_firmware:-" :
        {"family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q170mscpu-s1_firmware:-" :
        {"family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q172dcpu-s1_firmware:-" :
        {"family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q172dscpu_firmware:-" :
        {"family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q173dcpu-s1_firmware:-" :
        {"family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-q173dscpu_firmware:-" :
        {"family" : "MELSECQ"},
    "cpe:/o:mitsubishielectric:melsec_q-qmr-mq100_firmware:-" :
        {"family" : "MELSECQ"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
