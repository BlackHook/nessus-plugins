#%NASL_MIN_LEVEL 70300
##
# (C) Tenable Network Security, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(500352);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/04/18");

  script_cve_id("CVE-2019-13942");

  script_name(english:"Siemens (CVE-2019-13942)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in EN100 Ethernet module DNP3 variant (All versions), EN100 Ethernet module IEC
61850 variant (All versions < V4.37), EN100 Ethernet module IEC104 variant (All versions), EN100 Ethernet module Modbus
TCP variant (All versions), EN100 Ethernet module PROFINET IO variant (All versions). An unauthorized user could exploit
a buffer overflow vulnerability in the webserver. Specially crafted packets sent could cause a Denial-of-Service
condition and if certain conditions are met, the affected devices must be restarted manually to fully recover. At the
time of advisory publication no public exploitation of this security vulnerability was known.  

This plugin only works
with Tenable.ot. Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-418979.pdf");
  script_set_attribute(attribute:"see_also", value:"https://www.us-cert.gov/ics/advisories/icsa-19-344-07");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-13942");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(119);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/12/12");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/12/12");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/02/07");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:en100_ethernet_module_with_firmware_variant_dnp3_tcp");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:en100_ethernet_module_with_firmware_variant_iec104");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:en100_ethernet_module_with_firmware_variant_iec_61850");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:en100_ethernet_module_with_firmware_variant_modbus_tcp");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:en100_ethernet_module_with_firmware_variant_profinet_io");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:en100_ethernet_module_with_firmware_variant_dnp3_tcp" :
        {"family" : "Siprotec4"},
    "cpe:/o:siemens:en100_ethernet_module_with_firmware_variant_iec104" :
        {"family" : "Siprotec4"},
    "cpe:/o:siemens:en100_ethernet_module_with_firmware_variant_iec_61850" :
        {"versionEndExcluding" : "4.37", "family" : "Siprotec4"},
    "cpe:/o:siemens:en100_ethernet_module_with_firmware_variant_modbus_tcp" :
        {"family" : "Siprotec4"},
    "cpe:/o:siemens:en100_ethernet_module_with_firmware_variant_profinet_io" :
        {"family" : "Siprotec4"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
