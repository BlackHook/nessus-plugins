#%NASL_MIN_LEVEL 70300
##
# (C) Tenable, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(500424);
  script_version("1.4");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/06");

  script_cve_id("CVE-2014-0160");
  script_xref(name:"EDB-ID", value:"32745");
  script_xref(name:"EDB-ID", value:"32764");
  script_xref(name:"HP", value:"HPSBMU03029");
  script_xref(name:"HP", value:"HPSBMU03020");
  script_xref(name:"HP", value:"HPSBPI03014");
  script_xref(name:"HP", value:"HPSBMU02994");
  script_xref(name:"HP", value:"HPSBMU03040");
  script_xref(name:"HP", value:"HPSBMU02995");
  script_xref(name:"HP", value:"HPSBMU03009");
  script_xref(name:"HP", value:"HPSBMU03022");
  script_xref(name:"HP", value:"HPSBMU03024");
  script_xref(name:"HP", value:"HPSBST03000");
  script_xref(name:"HP", value:"HPSBHF03136");
  script_xref(name:"HP", value:"SSRT101846");
  script_xref(name:"HP", value:"HPSBMU03017");
  script_xref(name:"HP", value:"HPSBST03001");
  script_xref(name:"HP", value:"HPSBST03004");
  script_xref(name:"HP", value:"HPSBST03016");
  script_xref(name:"HP", value:"HPSBMU03032");
  script_xref(name:"HP", value:"HPSBGN03011");
  script_xref(name:"HP", value:"HPSBMU03013");
  script_xref(name:"HP", value:"HPSBMU03023");
  script_xref(name:"HP", value:"HPSBGN03008");
  script_xref(name:"HP", value:"HPSBPI03031");
  script_xref(name:"HP", value:"HPSBHF03021");
  script_xref(name:"HP", value:"HPSBMU03037");
  script_xref(name:"HP", value:"HPSBMU03012");
  script_xref(name:"HP", value:"HPSBMU03025");
  script_xref(name:"HP", value:"HPSBST03027");
  script_xref(name:"HP", value:"HPSBMU02999");
  script_xref(name:"HP", value:"HPSBST03015");
  script_xref(name:"HP", value:"HPSBMU02997");
  script_xref(name:"HP", value:"HPSBGN03010");
  script_xref(name:"HP", value:"HPSBMU03028");
  script_xref(name:"HP", value:"HPSBMU03044");
  script_xref(name:"HP", value:"HPSBMU03033");
  script_xref(name:"HP", value:"HPSBMU02998");
  script_xref(name:"HP", value:"HPSBMU03019");
  script_xref(name:"HP", value:"HPSBMU03030");
  script_xref(name:"HP", value:"HPSBMU03018");
  script_xref(name:"HP", value:"HPSBMU03062");
  script_xref(name:"RHSA", value:"RHSA-2014:0376");
  script_xref(name:"RHSA", value:"RHSA-2014:0396");
  script_xref(name:"RHSA", value:"RHSA-2014:0377");
  script_xref(name:"RHSA", value:"RHSA-2014:0378");
  script_xref(name:"SECUNIA", value:"57347");
  script_xref(name:"SECUNIA", value:"57483");
  script_xref(name:"SECUNIA", value:"57721");
  script_xref(name:"SECUNIA", value:"57966");
  script_xref(name:"SECUNIA", value:"57968");
  script_xref(name:"SECUNIA", value:"57836");
  script_xref(name:"SECUNIA", value:"59347");
  script_xref(name:"SECUNIA", value:"59243");
  script_xref(name:"SECUNIA", value:"59139");
  script_xref(name:"DSA", value:"DSA-2896");
  script_xref(name:"FEDORA", value:"FEDORA-2014-4879");
  script_xref(name:"FEDORA", value:"FEDORA-2014-4910");
  script_xref(name:"FEDORA", value:"FEDORA-2014-9308");
  script_xref(name:"SuSE", value:"openSUSE-SU-2014:0492");
  script_xref(name:"SuSE", value:"SUSE-SA:2014:002");
  script_xref(name:"SuSE", value:"openSUSE-SU-2014:0560");
  script_xref(name:"CERT", value:"TA14-098A");
  script_xref(name:"USN", value:"USN-2165-1");
  script_xref(name:"CISA-KNOWN-EXPLOITED", value:"2022/05/25");

  script_name(english:"Siemens (CVE-2014-0160)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"The (1) TLS and (2) DTLS implementations in OpenSSL 1.0.1 before
1.0.1g do not properly handle Heartbeat Extension packets, which
allows remote attackers to obtain sensitive information from process
memory via crafted packets that trigger a buffer over-read, as
demonstrated by reading private keys, related to d1_both.c and
t1_lib.c, aka the Heartbleed bug.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # http://git.openssl.org/gitweb/?p=openssl.git;a=commit;h=96db9023b881d7cd9f379b0c154650d6c108e9a3
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?8f4e30e1");
  script_set_attribute(attribute:"see_also", value:"https://bugzilla.redhat.com/show_bug.cgi?id=1084875");
  script_set_attribute(attribute:"see_also", value:"http://www.openssl.org/news/secadv_20140407.txt");
  script_set_attribute(attribute:"see_also", value:"http://heartbleed.com/");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1030078");
  script_set_attribute(attribute:"see_also", value:"http://seclists.org/fulldisclosure/2014/Apr/109");
  script_set_attribute(attribute:"see_also", value:"http://seclists.org/fulldisclosure/2014/Apr/190");
  # https://lists.balabit.hu/pipermail/syslog-ng-announce/2014-April/000184.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?bb05d3e3");
  # http://www.oracle.com/technetwork/topics/security/opensslheartbleedcve-2014-0160-2188454.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?3053dc8b");
  script_set_attribute(attribute:"see_also", value:"http://rhn.redhat.com/errata/RHSA-2014-0376.html");
  script_set_attribute(attribute:"see_also", value:"http://rhn.redhat.com/errata/RHSA-2014-0396.html");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1030082");
  script_set_attribute(attribute:"see_also", value:"http://secunia.com/advisories/57347");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139722163017074&w=2");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1030077");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=swg21670161");
  script_set_attribute(attribute:"see_also", value:"http://www.debian.org/security/2014/dsa-2896");
  script_set_attribute(attribute:"see_also", value:"http://rhn.redhat.com/errata/RHSA-2014-0377.html");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1030080");
  # http://lists.fedoraproject.org/pipermail/package-announce/2014-April/131221.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?93cd0f79");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1030074");
  script_set_attribute(attribute:"see_also", value:"http://seclists.org/fulldisclosure/2014/Apr/90");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1030081");
  # http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20140409-heartbleed
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?4f211d28");
  script_set_attribute(attribute:"see_also", value:"http://rhn.redhat.com/errata/RHSA-2014-0378.html");
  script_set_attribute(attribute:"see_also", value:"http://seclists.org/fulldisclosure/2014/Apr/91");
  script_set_attribute(attribute:"see_also", value:"http://secunia.com/advisories/57483");
  script_set_attribute(attribute:"see_also", value:"http://www.splunk.com/view/SP-CAAAMB3");
  # http://lists.fedoraproject.org/pipermail/package-announce/2014-April/131291.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?d79cd294");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1030079");
  # http://lists.opensuse.org/opensuse-security-announce/2014-04/msg00004.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?8e93b1c3");
  script_set_attribute(attribute:"see_also", value:"http://secunia.com/advisories/57721");
  script_set_attribute(attribute:"see_also", value:"http://www.blackberry.com/btsc/KB35882");
  script_set_attribute(attribute:"see_also", value:"http://www.securitytracker.com/id/1030026");
  # http://lists.opensuse.org/opensuse-security-announce/2014-04/msg00005.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?22274a45");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/66690");
  script_set_attribute(attribute:"see_also", value:"http://www.getchef.com/blog/2014/04/09/chef-server-11-0-12-release/");
  script_set_attribute(attribute:"see_also", value:"http://www.us-cert.gov/ncas/alerts/TA14-098A");
  script_set_attribute(attribute:"see_also", value:"http://www.getchef.com/blog/2014/04/09/enterprise-chef-1-4-9-release/");
  script_set_attribute(attribute:"see_also", value:"http://blog.fox-it.com/2014/04/08/openssl-heartbleed-bug-live-blog/");
  script_set_attribute(attribute:"see_also", value:"https://blog.torproject.org/blog/openssl-bug-cve-2014-0160");
  script_set_attribute(attribute:"see_also", value:"http://secunia.com/advisories/57966");
  script_set_attribute(attribute:"see_also", value:"http://www.f-secure.com/en/web/labs_global/fsc-2014-1");
  script_set_attribute(attribute:"see_also", value:"http://seclists.org/fulldisclosure/2014/Apr/173");
  script_set_attribute(attribute:"see_also", value:"http://www.getchef.com/blog/2014/04/09/enterprise-chef-11-1-3-release/");
  script_set_attribute(attribute:"see_also", value:"http://secunia.com/advisories/57968");
  script_set_attribute(attribute:"see_also", value:"https://code.google.com/p/mod-spdy/issues/detail?id=85");
  script_set_attribute(attribute:"see_also", value:"http://www.exploit-db.com/exploits/32745");
  script_set_attribute(attribute:"see_also", value:"http://www.kb.cert.org/vuls/id/720951");
  script_set_attribute(attribute:"see_also", value:"https://www.cert.fi/en/reports/2014/vulnerability788210.html");
  script_set_attribute(attribute:"see_also", value:"http://www.exploit-db.com/exploits/32764");
  script_set_attribute(attribute:"see_also", value:"http://secunia.com/advisories/57836");
  script_set_attribute(attribute:"see_also", value:"https://gist.github.com/chapmajs/10473815");
  # http://www.getchef.com/blog/2014/04/09/chef-server-heartbleed-cve-2014-0160-releases/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?8376305c");
  script_set_attribute(attribute:"see_also", value:"http://cogentdatahub.com/ReleaseNotes.html");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139905458328378&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139869891830365&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139889113431619&w=2");
  # http://public.support.unisys.com/common/public/vulnerability/NVD_Detail_Rpt.aspx?ID=1
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?ddfe97e6");
  script_set_attribute(attribute:"see_also", value:"http://www.kerio.com/support/kerio-control/release-history");
  # http://public.support.unisys.com/common/public/vulnerability/NVD_Detail_Rpt.aspx?ID=3
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?dcfb51d7");
  script_set_attribute(attribute:"see_also", value:"http://advisories.mageia.org/MGASA-2014-0165.html");
  # https://h20566.www2.hp.com/portal/site/hpsc/template.PAGE/public/kb/docDisplay/?spf_p.tpst=kbDocDisplay&spf_p.prp_kbDocDisplay=wsrp-navigationalState%3DdocId%253Demr_na-c04260637-4%257CdocLocale%253Den_US%257CcalledBy%253DSearch_Result&javax.portlet.begCacheTok=com.vignette.cachetoken&javax.portlet.endCacheTok=com.vignette.cachetoken
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?337f7a06");
  # http://www.oracle.com/technetwork/topics/security/cpujul2014-1972956.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?7de2f8eb");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=isg400001843");
  script_set_attribute(attribute:"see_also", value:"https://filezilla-project.org/versions.php?type=server");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=isg400001841");
  # https://support.f5.com/kb/en-us/solutions/public/15000/100/sol15159.html?sr=36517217
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?dcdcb279");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=141287864628122&w=2");
  script_set_attribute(attribute:"see_also", value:"http://seclists.org/fulldisclosure/2014/Dec/23");
  script_set_attribute(attribute:"see_also", value:"http://www.vmware.com/security/advisories/VMSA-2014-0012.html");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=142660345230545&w=2");
  # http://www.websense.com/support/article/kbarticle/Vulnerabilities-resolved-in-TRITON-APX-Version-8-0
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?c46d757d");
  script_set_attribute(attribute:"see_also", value:"http://www.mandriva.com/security/advisories?name=MDVSA-2015:062");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139817727317190&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139757726426985&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139758572430452&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139905653828999&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139842151128341&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139905405728262&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139833395230364&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139824993005633&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139843768401936&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139905202427693&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139774054614965&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139889295732144&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139835815211508&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=140724451518351&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139808058921905&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139836085512508&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139869720529462&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139905868529690&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139765756720506&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=140015787404650&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139824923705461&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139757919027752&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139774703817488&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139905243827825&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=140075368411126&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139905295427946&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139835844111589&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139757819327350&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139817685517037&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139905351928096&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=139817782017443&w=2");
  script_set_attribute(attribute:"see_also", value:"http://marc.info/?l=bugtraq&m=140752315422991&w=2");
  # http://www.symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160512_00
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?bd05ca98");
  script_set_attribute(attribute:"see_also", value:"http://www-01.ibm.com/support/docview.wss?uid=ssg1S1004661");
  # http://www.innominate.com/data/downloads/manuals/mdm_1.5.2.1_Release_Notes.pdf
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?bc543587");
  script_set_attribute(attribute:"see_also", value:"http://www.apcmedia.com/salestools/SJHN-7RKGNM/SJHN-7RKGNM_R4_EN.pdf");
  script_set_attribute(attribute:"see_also", value:"http://secunia.com/advisories/59347");
  script_set_attribute(attribute:"see_also", value:"http://secunia.com/advisories/59243");
  script_set_attribute(attribute:"see_also", value:"http://secunia.com/advisories/59139");
  # http://lists.fedoraproject.org/pipermail/package-announce/2014-August/136473.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f68d352b");
  # http://download.schneider-electric.com/files?p_Doc_Ref=SEVD%202014-119-01
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?31a74a0b");
  # https://support.f5.com/kb/en-us/solutions/public/15000/100/sol15159.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?b7354398");
  script_set_attribute(attribute:"see_also", value:"http://support.citrix.com/article/CTX140605");
  script_set_attribute(attribute:"see_also", value:"http://www.ubuntu.com/usn/USN-2165-1");
  script_set_attribute(attribute:"see_also", value:"http://lists.opensuse.org/opensuse-updates/2014-04/msg00061.html");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/archive/1/534161/100/0/threaded");
  # https://www.mitel.com/en-ca/support/security-advisories/mitel-product-security-advisory-17-0008
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?b3e9d2b8");
  # https://lists.apache.org/thread.html/ba661b0edd913b39ff129a32d855620dd861883ade05fd88a8ce517d@%3Cdev.tomcat.apache.org%3E
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?a6abc3fa");
  # https://lists.apache.org/thread.html/f8e0814e11c7f21f42224b6de111cb3f5e5ab5c15b78924c516d4ec2@%3Cdev.tomcat.apache.org%3E
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?e09c159e");
  # https://sku11army.blogspot.com/2020/01/heartbleed-hearts-continue-to-bleed.html
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?3aa4af59");
  # https://lists.apache.org/thread.html/rf8e8c091182b45daa50d3557cad9b10bb4198e3f08cf8f1c66a1b08d@%3Cdev.tomcat.apache.org%3E
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?37006736");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-635659.pdf");
  # https://lists.apache.org/thread.html/re3b72cbb13e1dfe85c4a06959a3b6ca6d939b407ecca80db12b54220@%3Cdev.tomcat.apache.org%3E
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?1c45738a");
  # https://yunus-shn.medium.com/ricon-industrial-cellular-router-heartbleed-attack-2634221c02bd
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?38336169");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:N/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2014-0160");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_set_attribute(attribute:"exploit_framework_core", value:"true");
  script_cwe_id(125);

  script_set_attribute(attribute:"vuln_publication_date", value:"2014/04/07");
  script_set_attribute(attribute:"patch_publication_date", value:"2014/04/07");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/02/07");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:cp_1543-1_firmware:1.1");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500_firmware:1.5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-1500t_firmware:1.5");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:cp_1543-1_firmware:1.1" :
        {"versionEndIncluding" : "1.1", "versionStartIncluding" : "1.1", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500_firmware:1.5" :
        {"versionEndIncluding" : "1.5", "versionStartIncluding" : "1.5", "family" : "S71500"},
    "cpe:/o:siemens:simatic_s7-1500t_firmware:1.5" :
        {"versionEndIncluding" : "1.5", "versionStartIncluding" : "1.5", "family" : "S71500"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
