#%NASL_MIN_LEVEL 70300
##
# (C) Tenable Network Security, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(500541);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2022/02/07");

  script_cve_id("CVE-2017-7928");

  script_name(english:"SEL (CVE-2017-7928)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"An Improper Access Control issue was discovered in Schweitzer Engineering Laboratories (SEL) SEL-3620 and SEL-3622
Security Gateway Versions R202 and, R203, R203-V1, R203-V2 and, R204, R204-V1. The device does not properly enforce
access control while configured for NAT port forwarding, which may allow for unauthorized communications to downstream
devices.  

This plugin only works with Tenable.ot. Please visit https://www.tenable.com/products/tenable-ot for more
information.");
  script_set_attribute(attribute:"see_also", value:"https://ics-cert.us-cert.gov/advisories/ICSA-17-192-06");
  script_set_attribute(attribute:"see_also", value:"http://www.securityfocus.com/bid/99536");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:P/A:P");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2017-7928");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");

  script_set_attribute(attribute:"vuln_publication_date", value:"2017/08/07");
  script_set_attribute(attribute:"patch_publication_date", value:"2017/08/07");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/02/07");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:selinc:sel-3620_firmware:r203");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:selinc:sel-3620_firmware:r203-v");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:selinc:sel-3620_firmware:r204-v1");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:selinc:sel-3620_firmware:r202");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:selinc:sel-3620_firmware:r203-v1");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:selinc:sel-3620_firmware:r204");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:selinc:sel-3622_firmware:r203-v1");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:selinc:sel-3622_firmware:r204");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:selinc:sel-3622_firmware:r202");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:selinc:sel-3622_firmware:r203");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:selinc:sel-3622_firmware:r203-v");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:selinc:sel-3622_firmware:r204-v1");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/SEL");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/SEL');

var asset = tenable_ot::assets::get(vendor:'SEL');

var vuln_cpes = {
    "cpe:/o:selinc:sel-3620_firmware:r203" :
        {"versionEndIncluding" : "r203", "versionStartIncluding" : "r203"},
    "cpe:/o:selinc:sel-3620_firmware:r203-v" :
        {"versionEndIncluding" : "r203-v", "versionStartIncluding" : "r203-v"},
    "cpe:/o:selinc:sel-3620_firmware:r204-v1" :
        {"versionEndIncluding" : "r204-v1", "versionStartIncluding" : "r204-v1"},
    "cpe:/o:selinc:sel-3620_firmware:r202" :
        {"versionEndIncluding" : "r202", "versionStartIncluding" : "r202"},
    "cpe:/o:selinc:sel-3620_firmware:r203-v1" :
        {"versionEndIncluding" : "r203-v1", "versionStartIncluding" : "r203-v1"},
    "cpe:/o:selinc:sel-3620_firmware:r204" :
        {"versionEndIncluding" : "r204", "versionStartIncluding" : "r204"},
    "cpe:/o:selinc:sel-3622_firmware:r203-v1" :
        {"versionEndIncluding" : "r203-v1", "versionStartIncluding" : "r203-v1"},
    "cpe:/o:selinc:sel-3622_firmware:r204" :
        {"versionEndIncluding" : "r204", "versionStartIncluding" : "r204"},
    "cpe:/o:selinc:sel-3622_firmware:r202" :
        {"versionEndIncluding" : "r202", "versionStartIncluding" : "r202"},
    "cpe:/o:selinc:sel-3622_firmware:r203" :
        {"versionEndIncluding" : "r203", "versionStartIncluding" : "r203"},
    "cpe:/o:selinc:sel-3622_firmware:r203-v" :
        {"versionEndIncluding" : "r203-v", "versionStartIncluding" : "r203-v"},
    "cpe:/o:selinc:sel-3622_firmware:r204-v1" :
        {"versionEndIncluding" : "r204-v1", "versionStartIncluding" : "r204-v1"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
