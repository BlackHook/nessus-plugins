#%NASL_MIN_LEVEL 70300
##
# (C) Tenable, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(500194);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/03/16");

  script_cve_id("CVE-2019-10923");

  script_name(english:"Siemens (CVE-2019-10923)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A vulnerability has been identified in Development/Evaluation Kits for
PROFINET IO: DK Standard Ethernet Controller, Development/Evaluation
Kits for PROFINET IO: EK-ERTEC 200, Development/Evaluation Kits for
PROFINET IO: EK-ERTEC 200P, SCALANCE X-200IRT switch family (incl.
SIPLUS NET variants), SIMATIC ET 200pro IM154-8 PN/DP CPU, SIMATIC ET
200pro IM154-8F PN/DP CPU, SIMATIC ET 200pro IM154-8FX PN/DP CPU,
SIMATIC ET 200S IM151-8 PN/DP CPU, SIMATIC ET 200S IM151-8F PN/DP CPU,
SIMATIC ET200ecoPN, 16DI, DC24V, 8xM12, SIMATIC ET200ecoPN, 16DO
DC24V/1,3A, 8xM12, SIMATIC ET200ecoPN, 4AO U/I 4xM12, SIMATIC
ET200ecoPN, 8 DIO, DC24V/1,3A, 8xM12, SIMATIC ET200ecoPN, 8 DO,
DC24V/2A, 8xM12, SIMATIC ET200ecoPN, 8AI RTD/TC 8xM12, SIMATIC
ET200ecoPN, 8AI; 4 U/I; 4 RTD/TC 8xM12, SIMATIC ET200ecoPN, 8DI,
DC24V, 4xM12, SIMATIC ET200ecoPN, 8DI, DC24V, 8xM12, SIMATIC
ET200ecoPN, 8DO, DC24V/0,5A, 4xM12, SIMATIC ET200ecoPN, 8DO,
DC24V/1,3A, 4xM12, SIMATIC ET200ecoPN, 8DO, DC24V/1,3A, 8xM12, SIMATIC
ET200ecoPN: IO-Link Master, SIMATIC ET200M (incl. SIPLUS variants),
SIMATIC ET200pro, SIMATIC ET200S (incl. SIPLUS variants), SIMATIC NET
CP 1604, SIMATIC NET CP 1616, SIMATIC PN/PN Coupler (incl. SIPLUS NET
variants), SIMATIC S7-300 CPU 314C-2 PN/DP, SIMATIC S7-300 CPU 315-2
PN/DP, SIMATIC S7-300 CPU 315F-2 PN/DP, SIMATIC S7-300 CPU 315T-3
PN/DP, SIMATIC S7-300 CPU 317-2 PN/DP, SIMATIC S7-300 CPU 317F-2
PN/DP, SIMATIC S7-300 CPU 317T-3 PN/DP, SIMATIC S7-300 CPU 317TF-3
PN/DP, SIMATIC S7-300 CPU 319-3 PN/DP, SIMATIC S7-300 CPU 319F-3
PN/DP, SIMATIC S7-400 PN/DP V6 and below CPU family (incl. SIPLUS
variants), SIMATIC S7-400 PN/DP V7 CPU family (incl. SIPLUS variants),
SIMATIC WinAC RTX 2010, SIMATIC WinAC RTX F 2010, SIMOTION (incl.
SIPLUS variants), SINAMICS DCM, SINAMICS DCP, SINAMICS G110M V4.7
Control Unit, SINAMICS G120 V4.7 Control Unit (incl. SIPLUS variants),
SINAMICS G130 V4.7 Control Unit, SINAMICS G150 Control Unit, SINAMICS
GH150 V4.7 Control Unit, SINAMICS GL150 V4.7 Control Unit, SINAMICS
GM150 V4.7 Control Unit, SINAMICS S110 Control Unit, SINAMICS S120
V4.7 Control Unit and CBE20 (incl. SIPLUS variants), SINAMICS S150
Control Unit, SINAMICS SL150 V4.7 Control Unit, SINAMICS SM120 V4.7
Control Unit, SINUMERIK 828D, SINUMERIK 840D sl, SIPLUS ET 200S
IM151-8 PN/DP CPU, SIPLUS ET 200S IM151-8F PN/DP CPU, SIPLUS S7-300
CPU 314C-2 PN/DP, SIPLUS S7-300 CPU 315-2 PN/DP, SIPLUS S7-300 CPU
315F-2 PN/DP, SIPLUS S7-300 CPU 317-2 PN/DP, SIPLUS S7-300 CPU 317F-2
PN/DP. An attacker with network access to an affected product may
cause a denial of service condition by breaking the real-time
synchronization (IRT) of the affected installation.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://cert-portal.siemens.com/productcert/pdf/ssa-349422.pdf");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:N/I:N/A:P");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-10923");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/10/10");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/10/10");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/02/07");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:scalance_x-200irt_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_et_200ecopn_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_et_200m_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_et_200s_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-300_cpu_312_ifm_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-300_cpu_313_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-300_cpu_314_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-300_cpu_314_ifm_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-300_cpu_315-2_dp_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-300_cpu_315_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-300_cpu_316-2_dp_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-300_cpu_318-2_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-300_cpu_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-400_dp_v7_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-400_pn_v7_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:siemens:simatic_s7-400_v6_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Siemens");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Siemens');

var asset = tenable_ot::assets::get(vendor:'Siemens');

var vuln_cpes = {
    "cpe:/o:siemens:scalance_x-200irt_firmware" :
        {"versionEndExcluding" : "5.2.1", "family" : "SCALANCEX200IRT"},
    "cpe:/o:siemens:simatic_et_200m_firmware" :
        {"family" : "ET200M"},
    "cpe:/o:siemens:simatic_et_200s_firmware" :
        {"family" : "ET200"},
    "cpe:/o:siemens:simatic_et_200ecopn_firmware" :
        {"family" : "ET200"},
    "cpe:/o:siemens:simatic_s7-300_cpu_firmware" :
        {"versionEndExcluding" : "3.3.17", "family" : "S7300"},
    "cpe:/o:siemens:simatic_s7-300_cpu_312_ifm_firmware" :
        {"versionEndExcluding" : "3.3.17", "family" : "S7300"},
    "cpe:/o:siemens:simatic_s7-300_cpu_313_firmware" :
        {"versionEndExcluding" : "3.3.17", "family" : "S7300"},
    "cpe:/o:siemens:simatic_s7-300_cpu_314_firmware" :
        {"versionEndExcluding" : "3.3.17", "family" : "S7300"},
    "cpe:/o:siemens:simatic_s7-300_cpu_314_ifm_firmware" :
        {"versionEndExcluding" : "3.3.17", "family" : "S7300"},
    "cpe:/o:siemens:simatic_s7-300_cpu_315_firmware" :
        {"versionEndExcluding" : "3.3.17", "family" : "S7300"},
    "cpe:/o:siemens:simatic_s7-300_cpu_315-2_dp_firmware" :
        {"versionEndExcluding" : "3.3.17", "family" : "S7300"},
    "cpe:/o:siemens:simatic_s7-300_cpu_316-2_dp_firmware" :
        {"versionEndExcluding" : "3.3.17", "family" : "S7300"},
    "cpe:/o:siemens:simatic_s7-300_cpu_318-2_firmware" :
        {"versionEndExcluding" : "3.3.17", "family" : "S7300"},
    "cpe:/o:siemens:simatic_s7-400_v6_firmware" :
        {"family" : "S7400"},
    "cpe:/o:siemens:simatic_s7-400_pn_v7_firmware" :
        {"family" : "S7400"},
    "cpe:/o:siemens:simatic_s7-400_dp_v7_firmware" :
        {"family" : "S7400"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
