#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(501202);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/07/06");

  script_cve_id("CVE-2019-6852");

  script_name(english:"Schneider (CVE-2019-6852)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"A CWE-200: Information Exposure vulnerability exists in Modicon
Controllers (M340 CPUs, M340 communication modules, Premium CPUs,
Premium communication modules, Quantum CPUs, Quantum communication
modules - see security notification for specific versions), which
could cause the disclosure of FTP hardcoded credentials when using the
Web server of the controller on an unsecure network.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  # https://www.se.com/ww/en/download/document/SEVD-2019-316-02/
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?72806cb8");
  script_set_attribute(attribute:"see_also", value:"https://www.se.com/ww/en/download/document/SEVD-2019-316-02/");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:P/I:N/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:U/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2019-6852");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(200);

  script_set_attribute(attribute:"vuln_publication_date", value:"2019/11/20");
  script_set_attribute(attribute:"patch_publication_date", value:"2019/11/20");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/06/29");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:schneider-electric:bmx_noc_0401_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:schneider-electric:bmx_noe_0100_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:schneider-electric:bmx_noe_0110_firmware");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:schneider-electric:bmx_p34x_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Schneider");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Schneider');

var asset = tenable_ot::assets::get(vendor:'Schneider');

var vuln_cpes = {
    "cpe:/o:schneider-electric:bmx_p34x_firmware" :
        {"family" : "ModiconM340"},
    "cpe:/o:schneider-electric:bmx_noe_0100_firmware" :
        {"family" : "ModiconM340M580CP"},
    "cpe:/o:schneider-electric:bmx_noe_0110_firmware" :
        {"family" : "ModiconM340M580CP"},
    "cpe:/o:schneider-electric:bmx_noc_0401_firmware" :
        {"family" : "ModiconM340M580CP"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_WARNING);
