#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('deprecated_nasl_level.inc');
include('compat.inc');

if (description)
{
  script_id(500699);
  script_version("1.2");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/02/22");

  script_cve_id("CVE-2022-33939");

  script_name(english:"Yokogawa (CVE-2022-33939)");

  script_set_attribute(attribute:"synopsis", value:
"The remote OT asset is affected by a vulnerability.");
  script_set_attribute(attribute:"description", value:
"CENTUM VP / CS 3000 controller FCS (CP31, CP33, CP345, CP401, and
CP451) contains an issue in processing communication packets, which
may lead to resource consumption. If this vulnerability is exploited,
an attacker may cause a denial of service (DoS) condition in ADL
communication by sending a specially crafted packet to the affected
product.

This plugin only works with Tenable.ot.
Please visit https://www.tenable.com/products/tenable-ot for more information.");
  script_set_attribute(attribute:"see_also", value:"https://jvn.jp/vu/JVNVU94343729/index.html");
  script_set_attribute(attribute:"see_also", value:"https://web-material3.yokogawa.com/1/33029/files/YSAR-22-0008-E.pdf");
  script_set_attribute(attribute:"see_also", value:"https://web-material3.yokogawa.com/19/33029/files/YSAR-22-0008-J.pdf");
  script_set_attribute(attribute:"solution", value:
"Refer to the vendor advisory.");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2022-33939");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_cwe_id(400);

  script_set_attribute(attribute:"vuln_publication_date", value:"2022/08/16");
  script_set_attribute(attribute:"patch_publication_date", value:"2022/08/16");
  script_set_attribute(attribute:"plugin_publication_date", value:"2022/08/18");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_cs_3000_cp31_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_cs_3000_cp33_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_cs_3000_cp345_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_cs_3000_cp401_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_cs_3000_cp451_firmware:-");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_vp_3000_cp401_firmware:r4");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_vp_3000_cp401_firmware:r5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_vp_3000_cp401_firmware:r6");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_vp_3000_cp451_firmware:r4");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_vp_3000_cp451_firmware:r5");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:yokogawa:centum_vp_3000_cp451_firmware:r6");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Tenable.ot");

  script_copyright(english:"This script is Copyright (C) 2022-2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("tenable_ot_api_integration.nasl");
  script_require_keys("Tenable.ot/Yokogawa");

  exit(0);
}


include('tenable_ot_cve_funcs.inc');

get_kb_item_or_exit('Tenable.ot/Yokogawa');

var asset = tenable_ot::assets::get(vendor:'Yokogawa');

var vuln_cpes = {
    "cpe:/o:yokogawa:centum_cs_3000_cp401_firmware:-" :
        {"family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_cs_3000_cp451_firmware:-" :
        {"family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_cs_3000_cp33_firmware:-" :
        {"family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_cs_3000_cp345_firmware:-" :
        {"family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_cs_3000_cp31_firmware:-" :
        {"family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_vp_3000_cp401_firmware:r6" :
        {"versionEndExcluding" : "r6.03.10", "versionStartIncluding" : "r6.01.00", "family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_vp_3000_cp401_firmware:r5" :
        {"versionEndExcluding" : "r5.04.78", "versionStartIncluding" : "r5.01.00", "family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_vp_3000_cp401_firmware:r4" :
        {"versionEndIncluding" : "r4.03.00", "versionStartIncluding" : "r4.01.00", "family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_vp_3000_cp451_firmware:r4" :
        {"versionEndIncluding" : "r4.03.00", "versionStartIncluding" : "r4.01.00", "family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_vp_3000_cp451_firmware:r5" :
        {"versionEndExcluding" : "r5.04.78", "versionStartIncluding" : "r5.01.00", "family" : "CentumVP"},
    "cpe:/o:yokogawa:centum_vp_3000_cp451_firmware:r6" :
        {"versionEndExcluding" : "r6.03.10", "versionStartIncluding" : "r6.01.00", "family" : "CentumVP"}
};

tenable_ot::cve::compare_and_report(asset:asset, cpes:vuln_cpes, severity:SECURITY_HOLE);
