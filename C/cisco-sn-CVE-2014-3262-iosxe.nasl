#TRUSTED 2969d3b447eab38e6cb87aba6b07a569870c53e28611ea3afb6f636fb59689cdac5f22973c6e6bd5dd6285b9accf86c77bb23188f3c6f030490937f5c25d0e52ec546170ccf7d8ee2a4ca6d2c6eedce94331dbc734fc10bb8cc655b70f3139106a3a29460dd7fa5971d9f398bc5c796394fb31d1fe527c8ac1bf334659641b6a7329bc0ad3fddceebc5c76a57084e5c0b1141f85af4b8165d85ae74487a986e21d163649eb1972a777ee20b6f8899e760d48a6896fce1f89eee5fad440dc1903fc73c09d46d26c25edc2ae04b0977390e47f26f4c75819cd05db934d1155b068a8ed06b4b63650a6f55c4d32368d04d8a720b13000e330517aa97ad74c5782be2fdcf0a56a8e89afd3da00a4526a85c0f2438636564493aeabbd4549606cd95134c59f4d01bc4936a24fa3fbdd4fb1dfe031cd1b400db919f314bf4040dd2311c506e7bdc80904bce74830b47fafd2e90f77d7a6a7470c80fd3bfd862d89736c0688dc2ecaa81895d6641e3554781568794b462691af9a190507b0c2a35826e1e8f09af15dbfb9f9546779b5399827df33a1488a8d3f7c52950282f742ef8476b18742d72f1425746963ba33aaba86ce64a71516de3749b174fcc31c17b443596e24d4ed44d754f5241a73c9f68ab64989f2c30dff059ea01923188fd3aecb9293e88319c32d317cd0ff62f276c65723af0d3321f5f81dcad1b958246c36f05b
#
# (C) Tenable Network Security, Inc.
#

include("compat.inc");

if (description)
{
  script_id(79250);
  script_version("1.9");
  script_cvs_date("Date: 2019/11/25");

  script_cve_id("CVE-2014-3262");
  script_bugtraq_id(67399);
  script_xref(name:"CISCO-BUG-ID", value:"CSCun73782");

  script_name(english:"Cisco IOS XE LISP ITR DoS (CSCun73782)");
  script_summary(english:"Checks IOS XE version.");

  script_set_attribute(attribute:"synopsis", value:
"The remote device is running a vulnerable IOS XE version.");
  script_set_attribute(attribute:"description", value:
"The remote Cisco device is potentially affected by an issue related to
the handling of certain parameters in Locator/ID Separation Protocol
(LISP) control messages sent to the ingress tunnel router (ITR)
component. A remote, unauthenticated attacker could exploit this issue
by sending specially crafted LISP control messages to cause a denial
of service.");
  # https://tools.cisco.com/security/center/viewAlert.x?alertId=34233
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?1b307af3");
  script_set_attribute(attribute:"see_also", value:"https://tools.cisco.com/security/center/viewAlert.x?alertId=34233");
  script_set_attribute(attribute:"solution", value:
"Upgrade to the relevant fixed version referenced in Cisco bug ID
CSCun73782.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:M/Au:N/C:N/I:N/A:P");
  script_set_cvss_temporal_vector("CVSS2#E:U/RL:OF/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2014-3262");

  script_set_attribute(attribute:"exploitability_ease", value:"No known exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"false");

  script_set_attribute(attribute:"vuln_publication_date", value:"2014/05/14");
  script_set_attribute(attribute:"patch_publication_date", value:"2014/05/30");
  script_set_attribute(attribute:"plugin_publication_date", value:"2014/11/14");

  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:cisco:ios_xe");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"CISCO");

  script_copyright(english:"This script is Copyright (C) 2014-2019 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("cisco_ios_xe_version.nasl");
  script_require_keys("Host/Cisco/IOS-XE/Version");

  exit(0);
}

include("audit.inc");
include("cisco_func.inc");
include("cisco_kb_cmd_func.inc");

version = get_kb_item_or_exit("Host/Cisco/IOS-XE/Version");
if (version !~ "^3\.10\.[0-2]S$" && version !~ "^3\.11\.[01]S$") audit(AUDIT_INST_VER_NOT_VULN, "Cisco IOS XE software", version);

flag     = FALSE;
override = FALSE;

if (get_kb_item("Host/local_checks_enabled"))
{
  buf = cisco_command_kb_item("Host/Cisco/Config/show_running-config", "show running-config");
  if (check_cisco_result(buf))
  {
    if (preg(multiline:TRUE, pattern:"^\s+ipv[46]\sitr(\s|$)", string:buf))
      flag = TRUE;
  }
  else if (cisco_needs_enable(buf)) override = TRUE;
}

if (!flag && !override) audit(AUDIT_HOST_NOT, "affected");

if (report_verbosity > 0)
{
  report =
    '\n  Cisco Bug ID        : CSCun73782' +
    '\n    Installed release : ' + version + 
    '\n';
  security_warning(port:0, extra:report+cisco_caveat(override));
}
else security_warning(port:0, extra:cisco_caveat(override));
