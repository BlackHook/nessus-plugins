#%NASL_MIN_LEVEL 80900
##
# (C) Tenable, Inc.
##

include('compat.inc');

if (description)
{
  script_id(177653);
  script_version("1.1");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/06/28");

  script_cve_id("CVE-2023-26083");
  script_xref(name:"CISA-KNOWN-EXPLOITED", value:"2023/04/28");

  script_name(english:"Arm Mali GPU Kernel Driver < r43p0 Information Exposure (CVE-2023-26083)");

  script_set_attribute(attribute:"synopsis", value:
"The remote host has a driver that is affected by an information disclosure vulnerability.");
  script_set_attribute(attribute:"description", value:
"The version of the Mali GPU Kernel Driver installed on the remote system is prior to r43p0 running on Migard, Bifrost,
Valhall or 5th Gen architecture. It is, therefore, affected by an information disclosure vulnerability. A
non-privileged user can make valid GPU processing operations that expose sensitive kernel metadata.

Note that Nessus has not tested for this issue but has instead relied only on the application's self-reported version
number.");
  # https://developer.arm.com/Arm%20Security%20Center/Mali%20GPU%20Driver%20Vulnerabilities
  script_set_attribute(attribute:"see_also", value:"http://www.nessus.org/u?f7073d53");
  script_set_attribute(attribute:"solution", value:
"Upgrade to Mali GPU Kernel Driver r43p0 or later.");
  script_set_attribute(attribute:"agent", value:"unix");
  script_set_cvss_base_vector("CVSS2#AV:L/AC:L/Au:S/C:P/I:N/A:N");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2023-26083");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");

  script_set_attribute(attribute:"vuln_publication_date", value:"2023/03/31");
  script_set_attribute(attribute:"patch_publication_date", value:"2023/03/31");
  script_set_attribute(attribute:"plugin_publication_date", value:"2023/06/27");

  script_set_attribute(attribute:"plugin_type", value:"local");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:arm:avalon_gpu_driver");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:arm:bifrost_gpu_driver");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:arm:valhall_gpu_driver");
  script_set_attribute(attribute:"cpe", value:"cpe:/a:arm:midgard");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Misc.");

  script_copyright(english:"This script is Copyright (C) 2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("arm_mali_driver_nix_installed.nbin");
  script_require_ports("installed_sw/Arm Mali GPU Driver");

  exit(0);
}

include('vcf_extras_arm.inc');

var app_info = vcf::arm::mali_gpu::get_app_info(app:'Arm Mali GPU Driver');

var constraints = [
  {'min_version': 'r0p0', 'max_version': 'r42p0', 'fixed_version': 'r43p0', 'family': 'Bifrost'},
  {'min_version': 'r19p0', 'max_version': 'r42p0', 'fixed_version': 'r43p0', 'family': 'Valhall'},
  {'min_version': 'r41p0', 'max_version': 'r42p0', 'fixed_version': 'r43p0', 'family': '5th Gen'},
  {'min_version': 'r6p0', 'max_version': 'r32p0', 'family': 'Midgard', 'fixed_display': 'See vendor advisory'}
];

vcf::arm::mali_gpu::check_version_and_report(app_info:app_info, constraints:constraints, severity:SECURITY_NOTE);
