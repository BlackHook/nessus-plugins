#
# (C) Tenable Network Security, Inc.
#

include('compat.inc');

if (description)
{
  script_id(117882);
  script_version("1.5");
  script_set_attribute(attribute:"plugin_modification_date", value:"2023/03/08");

  script_cve_id(
    "CVE-2018-10658",
    "CVE-2018-10659",
    "CVE-2018-10660",
    "CVE-2018-10661",
    "CVE-2018-10662",
    "CVE-2018-10663",
    "CVE-2018-10664"
  );

  script_name(english:"AXIS Multiple Vulnerabilities (ACV-128401)");

  script_set_attribute(attribute:"synopsis", value:
"The remote host is affected by multiple vulnerabilities.");
  script_set_attribute(attribute:"description", value:
"The firmware version running on the remote host is vulnerable to
multiple vulnerabilities. An unauthenticated remote attacker could
gain system-level unauthorized access to the affected device.

Note that Nessus has not tested for these issues but has instead
relied only on the application's self-reported version number.");
  script_set_attribute(attribute:"see_also", value:"https://www.axis.com/files/faq/Advisory_ACV-128401.pdf");
  script_set_attribute(attribute:"see_also", value:"https://www.axis.com/files/sales/ACV-128401_Affected_Product_List.pdf");
  script_set_attribute(attribute:"solution", value:
"Upgrade the host firmware to the version provided in the affected product list.");
  script_set_cvss_base_vector("CVSS2#AV:N/AC:L/Au:N/C:C/I:C/A:C");
  script_set_cvss_temporal_vector("CVSS2#E:F/RL:OF/RC:C");
  script_set_cvss3_base_vector("CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H");
  script_set_cvss3_temporal_vector("CVSS:3.0/E:F/RL:O/RC:C");
  script_set_attribute(attribute:"cvss_score_source", value:"CVE-2018-10662");

  script_set_attribute(attribute:"exploitability_ease", value:"Exploits are available");
  script_set_attribute(attribute:"exploit_available", value:"true");
  script_set_attribute(attribute:"metasploit_name", value:'Axis Network Camera .srv-to-parhand RCE');
  script_set_attribute(attribute:"exploit_framework_metasploit", value:"true");

  script_set_attribute(attribute:"vuln_publication_date", value:"2018/06/18");
  script_set_attribute(attribute:"patch_publication_date", value:"2018/06/18");
  script_set_attribute(attribute:"plugin_publication_date", value:"2018/10/02");

  script_set_attribute(attribute:"plugin_type", value:"remote");
  script_set_attribute(attribute:"cpe", value:"cpe:/o:axis:network_camera_firmware");
  script_end_attributes();

  script_category(ACT_GATHER_INFO);
  script_family(english:"Misc.");

  script_copyright(english:"This script is Copyright (C) 2018-2023 and is owned by Tenable, Inc. or an Affiliate thereof.");

  script_dependencies("axis_www_detect.nbin", "axis_ftp_detect.nbin");
  script_require_keys("installed_sw/AXIS device");
  script_require_ports("Services/www", "Services/ftp", 80, 21);

  exit(0);
}

include("vcf.inc");
include("vcf_extras.inc");

patches = make_array(
  'A1001', make_list('1.65.1'),
  'A8004-VE', make_list('1.65.2'),
  'A8105-E', make_list('1.65.2'),
  'A9161', make_list('1.65.0'),
  'A9188', make_list('1.65.0'),
  'A9188-VE', make_list('1.65.0'),
  'C1004-E', make_list('1.81.040.1'),
  'C2005', make_list('1.81.040.1'),
  'C3003-E', make_list('1.81.040.1'),
  'C8033', make_list('1.81.040.1'),
  'Companion Bullet LE', make_list('8.20.1'),
  'Companion C360', make_list('7.15.2.3'),
  'Companion Cube L', make_list('8.20.1'),
  'Companion Cube LW', make_list('8.20.1'),
  'Companion Dome V', make_list('8.20.1'),
  'Companion Dome WV', make_list('8.20.1'),
  'Companion Eye L', make_list('8.20.1'),
  'Companion Eye LVE', make_list('8.20.1'),
  'Companion Recorder 4CH', make_list('1.20.1'),
  'Companion Recorder 8CH', make_list('1.20.1'),
  'D2050-VE', make_list('7.35.4.2'),
  'F34 Main Unit', make_list('6.50.2.3'),
  'F41 Main Unit', make_list('6.50.2.3'),
  'F44 Dual Audio Input', make_list('6.50.2.3'),
  'F44 Main Unit', make_list('6.50.2.3'),
  'FA54 Main Unit', make_list('6.55.4.5'),
  'M1004-W', make_list('5.51.5'),
  'M1013', make_list('5.51.5'),
  'M1014', make_list('5.51.5'),
  'M1025', make_list('5.51.5'),
  'M1033-W', make_list('5.51.5'),
  'M1034-W', make_list('5.51.5'),
  'M1045-LW', make_list('8.20.1'),
  'M1054', make_list('5.51.5'),
  'M1065-L', make_list('8.20.1'),
  'M1065-LW', make_list('8.20.1'),
  'M1103', make_list('5.51.5'),
  'M1104', make_list('5.51.5'),
  'M1113', make_list('5.51.5'),
  'M1113-E', make_list('5.51.5'),
  'M1114', make_list('5.51.5'),
  'M1114-E', make_list('5.51.5'),
  'M1124', make_list('6.50.2.3', '8.30.1'),
  'M1124-E', make_list('6.50.2.3', '8.30.1'),
  'M1125', make_list('6.50.2.3', '8.30.1'),
  'M1125-E', make_list('6.50.2.3', '8.30.1'),
  'M1143-L', make_list('5.60.1.10'),
  'M1144-L', make_list('5.60.1.10'),
  'M1145', make_list('6.50.2.3'),
  'M1145-L', make_list('6.50.2.3'),
  'M2014-E', make_list('5.51.5'),
  'M2025-LE', make_list('8.20.1'),
  'M2026-LE', make_list('8.20.1'),
  'M2026-LE Mk II', make_list('8.10.1.1'),
  'M3004-V', make_list('5.51.5'),
  'M3005-V', make_list('5.51.5'),
  'M3006-V', make_list('6.50.2.3'),
  'M3007-P', make_list('6.50.2.3'),
  'M3007-PV', make_list('6.50.2.3'),
  'M3014', make_list('5.51.5'),
  'M3015', make_list('7.15.5.1'),
  'M3016', make_list('7.15.5.1'),
  'M3024-LVE', make_list('5.51.5'),
  'M3025-VE', make_list('5.51.5'),
  'M3026-VE', make_list('6.50.2.3'),
  'M3027-PVE', make_list('6.50.2.3'),
  'M3037-PVE', make_list('6.55.1'),
  'M3044-V', make_list('8.20.1'),
  'M3044-WV', make_list('8.20.1'),
  'M3045-V', make_list('8.20.1'),
  'M3045-WV', make_list('8.20.1'),
  'M3046-V', make_list('8.20.1'),
  'M3046-V 1.8mm', make_list('8.20.1'),
  'M3047-P', make_list('7.15.2.3'),
  'M3048-P', make_list('7.15.2.3'),
  'M3104-L', make_list('8.20.1'),
  'M3104-LVE', make_list('8.20.1'),
  'M3105-L', make_list('8.20.1'),
  'M3105-LVE', make_list('8.20.1'),
  'M3106-L', make_list('8.20.1'),
  'M3106-L Mk II', make_list('8.10.1.1'),
  'M3106-LVE', make_list('8.20.1'),
  'M3106-LVE Mk II', make_list('8.10.1.1'),
  'M3113-R', make_list('5.51.5'),
  'M3113-VE', make_list('5.51.5'),
  'M3114-R', make_list('5.51.5'),
  'M3114-VE', make_list('5.51.5'),
  'M3203', make_list('5.51.5'),
  'M3203-V', make_list('5.51.5'),
  'M3204', make_list('5.51.5'),
  'M3204-V', make_list('5.51.5'),
  'M5013', make_list('5.51.5'),
  'M5013-V', make_list('5.51.5'),
  'M5014', make_list('5.51.5'),
  'M5014-V', make_list('5.51.5'),
  'M5054', make_list('6.53.2.1'),
  'M5055', make_list('6.53.2.1'),
  'M5065', make_list('6.53.2.1'),
  'M5525-E', make_list('8.20.1'),
  'M7010', make_list('5.51.5'),
  'M7011', make_list('6.50.2.3'),
  'M7014', make_list('5.51.5'),
  'M7016', make_list('5.51.5'),
  'P1125-Z', make_list('7.10.1.1'),
  'P1125-ZL', make_list('7.10.1.1'),
  'P1126-Z', make_list('7.10.1.1'),
  'P1126-ZL', make_list('7.10.1.1'),
  'P1204', make_list('5.51.5'),
  'P1214', make_list('5.51.5'),
  'P1214-E', make_list('5.51.5'),
  'P1224-E', make_list('5.51.5'),
  'P1244', make_list('6.50.2.3', '8.20.1'),
  'P1245', make_list('6.50.2.3', '8.20.1'),
  'P1254', make_list('6.50.2.3', '8.20.1'),
  'P1264', make_list('6.50.2.3', '8.20.1'),
  'P1265', make_list('6.50.2.3', '8.20.1'),
  'P1275', make_list('6.50.2.3', '8.20.1'),
  'P1280', make_list('6.55.2.3'),
  'P1290', make_list('6.55.2.3'),
  'P1325-Z', make_list('7.10.1.1'),
  'P1343', make_list('5.51.5'),
  'P1343-E', make_list('5.51.5'),
  'P1344', make_list('5.51.5'),
  'P1344-E', make_list('5.51.5'),
  'P1346', make_list('5.51.5'),
  'P1346-E', make_list('5.51.5'),
  'P1347', make_list('5.51.5'),
  'P1347-E', make_list('5.51.5'),
  'P1353', make_list('6.50.2.3'),
  'P1353-E', make_list('6.50.2.3'),
  'P1354', make_list('6.50.2.3'),
  'P1354-E', make_list('6.50.2.3'),
  'P1355', make_list('5.60.1.10'),
  'P1355-E', make_list('5.60.1.10'),
  'P1357', make_list('6.50.2.3'),
  'P1357-E', make_list('6.50.2.3'),
  'P1364', make_list('6.50.2.3', '8.20.1'),
  'P1364-E', make_list('6.50.2.3', '8.20.1'),
  'P1365', make_list('6.50.2.3'),
  'P1365 Mk II', make_list('6.50.2.3', '8.20.1'),
  'P1365-E', make_list('6.50.2.3'),
  'P1365-E Mk II', make_list('6.50.2.3', '8.20.1'),
  'P1367', make_list('8.20.1'),
  'P1367-E', make_list('8.20.1'),
  'P1368-E', make_list('8.20.1'),
  'P1405-E', make_list('6.50.2.3'),
  'P1405-LE', make_list('6.50.2.3'),
  'P1405-LE Mk II', make_list('8.20.1'),
  'P1425-E', make_list('6.50.2.3'),
  'P1425-LE', make_list('6.50.2.3'),
  'P1425-LE Mk II', make_list('8.20.1'),
  'P1427-E', make_list('6.50.2.3'),
  'P1427-LE', make_list('6.50.2.3'),
  'P1428-E', make_list('6.50.2.3'),
  'P1435-E', make_list('6.50.2.3', '8.20.1'),
  'P1435-LE', make_list('6.50.2.3', '8.20.1'),
  'P1447-LE', make_list('8.20.1'),
  'P1448-LE', make_list('8.20.1'),
  'P3114-I', make_list('6.50.3.2'),
  'P3114-Z', make_list('6.50.3.2'),
  'P3115-I', make_list('6.50.3.2'),
  'P3115-Z', make_list('6.50.3.2'),
  'P3125-Z', make_list('7.10.1.1'),
  'P3214-V', make_list('6.50.2.3'),
  'P3214-VE', make_list('6.50.2.3'),
  'P3215-V', make_list('6.50.2.3'),
  'P3215-VE', make_list('6.50.2.3'),
  'P3224-LV', make_list('6.50.2.3'),
  'P3224-LV Mk II', make_list('8.20.1'),
  'P3224-LVE', make_list('6.50.2.3'),
  'P3224-LVE Mk II', make_list('8.20.1'),
  'P3224-V Mk II', make_list('8.20.1'),
  'P3224-VE Mk II', make_list('8.20.1'),
  'P3225-LV', make_list('6.50.2.3'),
  'P3225-LV Mk II', make_list('8.20.1'),
  'P3225-LVE', make_list('6.50.2.3'),
  'P3225-LVE Mk II', make_list('8.20.1'),
  'P3225-V Mk II', make_list('8.20.1'),
  'P3225-VE Mk II', make_list('8.20.1'),
  'P3227-LV', make_list('8.20.1'),
  'P3227-LVE', make_list('8.20.1'),
  'P3228-LV', make_list('8.20.1'),
  'P3228-LVE', make_list('8.20.1'),
  'P3301', make_list('5.51.5'),
  'P3301-V', make_list('5.51.5'),
  'P3304', make_list('5.51.5'),
  'P3304-V', make_list('5.51.5'),
  'P3314-Z', make_list('6.50.3'),
  'P3314-ZL', make_list('6.50.3'),
  'P3315-Z', make_list('6.50.3'),
  'P3315-ZL', make_list('6.50.3'),
  'P3343', make_list('5.51.5'),
  'P3343-V', make_list('5.51.5'),
  'P3343-VE', make_list('5.51.5'),
  'P3344', make_list('5.51.5'),
  'P3344-V', make_list('5.51.5'),
  'P3344-VE', make_list('5.51.5'),
  'P3346', make_list('5.51.5'),
  'P3346-V', make_list('5.51.5'),
  'P3346-VE', make_list('5.51.5'),
  'P3353', make_list('6.50.2.3'),
  'P3354', make_list('6.50.2.3'),
  'P3363-V', make_list('6.50.2.3'),
  'P3363-VE', make_list('6.50.2.3'),
  'P3364-LV', make_list('6.50.2.3'),
  'P3364-LVE', make_list('6.50.2.3'),
  'P3364-V', make_list('6.50.2.3'),
  'P3364-VE', make_list('6.50.2.3'),
  'P3365-V', make_list('6.50.2.3'),
  'P3365-VE', make_list('6.50.2.3'),
  'P3367-V', make_list('6.50.2.3'),
  'P3367-VE', make_list('6.50.2.3'),
  'P3374-LV', make_list('8.20.1'),
  'P3374-V', make_list('8.20.1'),
  'P3375-LV', make_list('8.20.1'),
  'P3375-LVE', make_list('8.20.1'),
  'P3375-V', make_list('8.20.1'),
  'P3375-VE', make_list('8.20.1'),
  'P3384-V', make_list('6.50.2.3'),
  'P3384-VE', make_list('6.50.2.3'),
  'P3705-Z', make_list('6.40.3.2'),
  'P3706-Z', make_list('6.40.3.2'),
  'P3707-PE', make_list('6.50.2.3'),
  'P3904-R', make_list('6.50.2.3'),
  'P3904-R Mk II', make_list('6.50.2.3'),
  'P3905-R', make_list('6.50.2.3'),
  'P3905-R Mk II', make_list('6.50.2.3'),
  'P3905-RE', make_list('6.50.2.3'),
  'P3915-R', make_list('6.50.2.3'),
  'P3915-R Mk II', make_list('6.50.2.3'),
  'P5414-E', make_list('6.50.2.3'),
  'P5415-E', make_list('6.50.2.3'),
  'P5512', make_list('5.51.5'),
  'P5512-E', make_list('5.51.5'),
  'P5514', make_list('6.50.2.3', '8.20.1'),
  'P5514-E', make_list('6.50.2.3', '8.20.1'),
  'P5515', make_list('6.50.2.3', '8.20.1'),
  'P5515-E', make_list('6.50.2.3', '8.20.1'),
  'P5522', make_list('5.51.5'),
  'P5522-E', make_list('5.51.5'),
  'P5532', make_list('5.41.4'),
  'P5532-E', make_list('5.41.4'),
  'P5534', make_list('5.41.4'),
  'P5534-E', make_list('5.41.4'),
  'P5544', make_list('5.41.2.6'),
  'P5624-E', make_list('6.50.2.3'),
  'P5624-E Mk II', make_list('6.50.2.3', '8.20.1'),
  'P5635-E', make_list('6.50.2.3'),
  'P5635-E Mk II', make_list('6.50.2.3', '8.20.1'),
  'P5635-ZE', make_list('5.75.3.3'),
  'P7210', make_list('5.51.5'),
  'P7214', make_list('5.51.5'),
  'P7216', make_list('5.51.5'),
  'P7224 Blade', make_list('5.51.5'),
  'P8513', make_list('5.51.5'),
  'P8514', make_list('5.51.5'),
  'P8524', make_list('5.51.5'),
  'Q1602', make_list('6.50.2.3'),
  'Q1602-E', make_list('6.50.2.3'),
  'Q1604', make_list('6.50.2.3'),
  'Q1604-E', make_list('6.50.2.3'),
  'Q1605-Z', make_list('7.10.1.1'),
  'Q1614', make_list('6.50.2.3'),
  'Q1614-E', make_list('6.50.2.3'),
  'Q1615', make_list('6.50.2.3'),
  'Q1615 Mk II', make_list('8.20.1'),
  'Q1615-E', make_list('6.50.2.3'),
  'Q1615-E Mk II', make_list('8.20.1'),
  'Q1635', make_list('6.50.2.3'),
  'Q1635-E', make_list('6.50.2.3'),
  'Q1635-Z', make_list('6.50.3'),
  'Q1645', make_list('8.20.1'),
  'Q1647', make_list('8.20.1'),
  'Q1659', make_list('6.56.2.1'),
  'Q1755', make_list('5.51.5'),
  'Q1755-E', make_list('5.51.5'),
  'Q1765-LE', make_list('6.50.2.3'),
  'Q1765-LE PT Mount', make_list('6.50.2.3'),
  'Q1775', make_list('6.50.2.3', '8.20.1'),
  'Q1775-E', make_list('6.50.2.3', '8.20.1'),
  'Q1910', make_list('5.51.5'),
  'Q1910-E', make_list('5.51.5'),
  'Q1921', make_list('5.51.5'),
  'Q1921-E', make_list('5.51.5'),
  'Q1922', make_list('5.51.5'),
  'Q1922-E', make_list('5.51.5'),
  'Q1931-E', make_list('6.50.2.3'),
  'Q1931-E PT Mount', make_list('6.50.2.3'),
  'Q1932-E', make_list('6.50.2.3'),
  'Q1932-E PT Mount', make_list('6.50.2.3'),
  'Q1941-E', make_list('8.20.1'),
  'Q1941-E PT Mount', make_list('6.55.1.2'),
  'Q1942-E', make_list('8.20.1'),
  'Q1942-E PT Mount', make_list('6.55.1.2'),
  'Q2901-E', make_list('6.50.2.3'),
  'Q2901-E PT Mount', make_list('6.50.2.3'),
  'Q3504-V', make_list('8.20.1'),
  'Q3504-VE', make_list('8.20.1'),
  'Q3505-SVE Mk II', make_list('8.20.1'),
  'Q3505-V', make_list('6.50.2.3'),
  'Q3505-V Mk II', make_list('8.20.1'),
  'Q3505-VE', make_list('6.50.2.3'),
  'Q3505-VE Mk II', make_list('8.20.1'),
  'Q3515-LV', make_list('8.20.1'),
  'Q3515-LVE', make_list('8.20.1'),
  'Q3517-LV', make_list('8.20.1'),
  'Q3517-LVE', make_list('8.20.1'),
  'Q3615-VE', make_list('8.20.1'),
  'Q3617-VE', make_list('8.20.1'),
  'Q3708-PVE', make_list('5.95.4.7'),
  'Q3709-PVE', make_list('5.75.1.9'),
  'Q6000-E', make_list('6.50.2.3'),
  'Q6000-E Mk II', make_list('6.50.2.3'),
  'Q6032', make_list('5.41.4'),
  'Q6032-C', make_list('5.41.3.4'),
  'Q6032-E', make_list('5.41.4'),
  'Q6034', make_list('5.41.4'),
  'Q6034-C', make_list('5.41.3.4'),
  'Q6034-E', make_list('5.41.4'),
  'Q6035', make_list('5.41.4'),
  'Q6035-C', make_list('5.41.4'),
  'Q6035-E', make_list('5.41.4'),
  'Q6042', make_list('6.50.2.3'),
  'Q6042-C', make_list('6.50.2.3'),
  'Q6042-E', make_list('6.50.2.3'),
  'Q6042-S', make_list('6.50.2.3'),
  'Q6044', make_list('6.50.2.3'),
  'Q6044-C', make_list('6.50.2.3'),
  'Q6044-E', make_list('6.50.2.3'),
  'Q6044-S', make_list('6.50.2.3'),
  'Q6045', make_list('5.70.1.7'),
  'Q6045 Mk II', make_list('6.50.2.3'),
  'Q6045-C', make_list('5.70.1.7'),
  'Q6045-C Mk II', make_list('6.50.2.3'),
  'Q6045-E', make_list('5.70.1.7'),
  'Q6045-E Mk II', make_list('6.50.2.3'),
  'Q6045-S', make_list('5.70.1.7'),
  'Q6045-S Mk II', make_list('6.50.2.3'),
  'Q6052', make_list('6.50.2.3', '8.20.1'),
  'Q6052-E', make_list('6.50.2.3', '8.20.1'),
  'Q6054', make_list('6.50.2.3', '8.20.1'),
  'Q6054 Mk II', make_list('8.20.1'),
  'Q6054-E', make_list('6.50.2.3', '8.20.1'),
  'Q6054-E Mk II', make_list('8.20.1'),
  'Q6055', make_list('6.50.2.3', '8.20.1'),
  'Q6055-C', make_list('6.50.2.3', '8.20.1'),
  'Q6055-E', make_list('6.50.2.3', '8.20.1'),
  'Q6055-S', make_list('6.50.2.3', '8.20.1'),
  'Q6114-E', make_list('6.50.2.3'),
  'Q6115-E', make_list('6.50.2.3'),
  'Q6124-E', make_list('8.20.1'),
  'Q6125-LE', make_list('8.20.1'),
  'Q6128-E', make_list('6.50.2.3'),
  'Q6155-E', make_list('6.50.2.3', '8.20.1'),
  'Q7401', make_list('5.51.5'),
  'Q7404', make_list('5.51.5'),
  'Q7406 Blade', make_list('5.51.5'),
  'Q7411', make_list('6.50.2.3'),
  'Q7414 Blade', make_list('5.51.5'),
  'Q7424-R', make_list('5.51.5'),
  'Q7424-R Mk II', make_list('5.51.3.5'),
  'Q7436 Blade', make_list('6.50.2.3'),
  'Q8414-LVS', make_list('6.50.2.3'),
  'Q8631-E', make_list('6.50.2.3'),
  'Q8632-E', make_list('6.50.2.3'),
  'Q8641-E', make_list('6.55.1.2'),
  'Q8642-E', make_list('6.55.1.2'),
  'Q8655-ZLE', make_list('5.55.2.5'),
  'Q8665-E', make_list('6.50.2.3'),
  'Q8665-LE', make_list('6.50.2.3'),
  'Q8675-ZE', make_list('6.20.3.2'),
  'Q8685-E', make_list('6.55.1.3'),
  'Q8685-LE', make_list('6.55.1.3'),
  'Q8721-E', make_list('5.50.2.5'),
  'Q8722-E', make_list('5.50.2.5'),
  'Q8741-E', make_list('7.15.3.2'),
  'Q8741-LE', make_list('7.15.3.2'),
  'Q8742-E', make_list('7.15.3.2'),
  'Q8742-LE', make_list('7.15.3.2'),
  'Q8742-E Zoom', make_list('7.15.3.2'),
  'Q8742-LE Zoom', make_list('7.15.3.2'),
  'V5914', make_list('5.75.1.10'),
  'V5915', make_list('5.75.1.10')
);

app_info = vcf::axis::get_app_info();
constraints = vcf::axis::generate_constraints(app_info:app_info, patch_array:patches);
vcf::check_version_and_report(app_info:app_info, constraints:constraints, severity:SECURITY_HOLE);
